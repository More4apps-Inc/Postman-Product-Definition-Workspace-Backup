{"collection":{"info":{"_postman_id":"19bc6f5b-9fee-4b0c-bf25-f19a1e46d695","name":"LimitedSQLTesting","schema":"https://schema.getpostman.com/json/collection/v2.1.0/collection.json","updatedAt":"2023-01-11T02:25:06.000Z","createdAt":"2022-11-24T00:41:28.000Z","lastUpdatedBy":"5845306","uid":"5845306-19bc6f5b-9fee-4b0c-bf25-f19a1e46d695"},"item":[{"name":"RunTest","event":[{"listen":"test","script":{"id":"dc427cdd-b907-4f20-bc24-06c7a826d096","exec":["// Diable/Enable base64\r","pm.variables.set(\"p_base64\",\"N\");\r","pm.variables.set(\"LimitedSql\",\"Y\");\r","\r","const instanceUrl = pm.environment.get(\"urlprefix\")  + pm.environment.get(\"hostname\") + \".\"+ \"more4apps.com\" + \":\" + pm.environment.get(\"port\") + \"/OA_HTML\";\r","console.log(instanceUrl);\r","//console.log('is logged in: ' + pm.variables.get(\"hasLogged\"));\r","\r","//Login URL\r","const loginUrl = instanceUrl + \"/fndvald.jsp?username=\" + pm.globals.get(\"globaluser\") + \"&password=\" + pm.globals.get(\"password\");\r","\r","const loginRequest = {\r","  url: instanceUrl + '/m4aServlet/login',\r","               method: \"POST\",\r","                header: {'Content-Type': 'application/x-www-form-urlencoded'},\r","                body: {\r","                    mode: 'urlencoded',\r","          urlencoded: [{key: \"p_username\", value: \"SERVICES\", disabled: false}, {key: \"p_password\", value: \"welcome\", disabled: false}]}\r"," }\r"," \r","\r","\r","// Login\r","if(!pm.variables.get(\"hasLogged\")) {\r","     pm.sendRequest(loginRequest, (error, response) => {\r","        if (error) {\r","            console.log(error);\r","        } else {\r","            pm.variables.set(\"hasLogged\", true);\r","            console.log(response);\r","        }\r","    });\r","}\r","\r","\r","\r","// Send request based on servlet name\r","postman.setNextRequest(data.Servlet);"],"type":"text/javascript"}},{"listen":"prerequest","script":{"id":"6d1a7639-abc4-47cb-af52-e5a0e5e506d4","exec":[""],"type":"text/javascript"}}],"id":"30650442-60ff-411f-8c6a-039aba3279ed","protocolProfileBehavior":{"disableBodyPruning":true},"request":{"method":"GET","header":[],"url":{"raw":"{{base_servlet_url}}/Hello","host":["{{base_servlet_url}}"],"path":["Hello"]}},"response":[],"uid":"5845306-30650442-60ff-411f-8c6a-039aba3279ed"},{"name":"sql","event":[{"listen":"test","script":{"id":"4ce80a08-9530-4278-99bd-535942471957","exec":["","tests[\"Status code is 200\"] = responseCode.code === 200;","if(data.error_code !== \"\" && pm.variables.get(\"LimitedSql\")==\"Y\"){","    pm.test(data.Description, function () {","        pm.expect(pm.response.text()).to.include(\"<ERROR_MESSAGE>\");","        pm.expect(pm.response.text()).to.include(\"SECURITY VIOLATION: \" + data.error_code);","    });","} else {","    pm.test(\"Should not return security violation error\", function(){","        pm.expect(pm.response.text()).to.not.include(\"<SECURITY VIOLATION\");","    });","}","","//clear variables","pm.variables.set(\"p_sql\",\"\");","pm.variables.set(\"p_init\",\"\");","","// Exit run","postman.setNextRequest(null);"],"type":"text/javascript"}},{"listen":"prerequest","script":{"id":"99f88823-0349-4633-8f8b-b9ed11cec7ad","exec":["\r","if(data.p_sql !== \"\"){\r","    console.log(\"p_sql==\" + data.p_sql);\r","    if(pm.variables.get(\"p_base64\")==\"Y\")\r","        pm.variables.set(\"p_sql\",btoa(data.p_sql));\r","    else\r","        pm.variables.set(\"p_sql\", data.p_sql);\r","}\r","\r","if(data.p_init !== \"\"){\r","     console.log(\"p_init==\" + data.p_init);\r","     if(pm.variables.get(\"p_base64\")==\"Y\")\r","        pm.variables.set(\"p_init\",btoa(data.p_init));\r","    else\r","        pm.variables.set(\"p_init\", data.p_init);\r","}\r","    "],"type":"text/javascript"}}],"id":"071fa327-a789-47de-abf0-da3e15e30090","protocolProfileBehavior":{"disableBodyPruning":true},"request":{"method":"POST","header":[{"key":"Content-Type","value":"application/x-www-form-urlencoded"}],"body":{"mode":"urlencoded","urlencoded":[{"key":"p_sql","type":"text","value":"{{p_sql}}"},{"key":"p_init","type":"text","value":"{{p_init}}"},{"key":"p_base64","value":"{{p_base64}}","type":"text"}]},"url":{"raw":"{{base_servlet_url}}/sql","host":["{{base_servlet_url}}"],"path":["sql"]}},"response":[],"uid":"5845306-071fa327-a789-47de-abf0-da3e15e30090"},{"name":"block","event":[{"listen":"prerequest","script":{"id":"65023ac8-0521-4c5b-a83e-a2529202ac64","exec":["pm.environment.set(\"p_block\",btoa(data.p_block));\r","pm.environment.set(\"p_custom_select\",btoa(data.p_custom_select));\r","\r","\r","\r","if(data.p_block !== \"\"){\r","    console.log(\"p_block==\" + data.p_block);\r","    if(pm.variables.get(\"p_base64\")==\"Y\")\r","        pm.variables.set(\"p_block\",btoa(data.p_block));\r","    else\r","        pm.variables.set(\"p_block\", data.p_block);\r","}\r","\r","if(!data.p_custom_select !== \"\"){\r","     console.log(\"p_custom_select==\" + data.p_custom_select);\r","    if(pm.variables.get(\"p_base64\")==\"Y\")\r","        pm.variables.set(\"p_custom_select\",btoa(data.p_custom_select));\r","    else\r","        pm.variables.set(\"p_custom_select\", data.p_custom_select);\r","}\r","    "],"type":"text/javascript"}},{"listen":"test","script":{"id":"77e4f756-edaf-4813-becc-666a1fa5c203","exec":["\r","tests[\"Status code is 200\"] = responseCode.code === 200;\r","if(data.error_code !== \"\" && pm.variables.get(\"LimitedSql\")==\"Y\"){\r","    //console.log(pm.response.text());\r","    console.log(data.error_code);\r","    pm.test(data.Description, function () {\r","        pm.expect(pm.response.text()).to.include(\"<ERROR_MESSAGE>\");\r","        pm.expect(pm.response.text()).to.include(\"SECURITY VIOLATION: \" + data.error_code);\r","    });\r","} else {\r","    pm.test(\"Should not return security violation error\", function(){\r","        pm.expect(pm.response.text()).to.not.include(\"<SECURITY VIOLATION\");\r","    });\r","\r","}\r","\r","//clear variables\r","pm.variables.set(\"p_block\",\"\");\r","pm.variables.set(\"p_custom_select\",\"\");\r","\r","\r","// Exit run\r","postman.setNextRequest(null);"],"type":"text/javascript"}}],"id":"002821ce-c9af-4c71-8864-9e0ae4bb2f83","protocolProfileBehavior":{"disableBodyPruning":true},"request":{"method":"POST","header":[{"key":"Content-Type","value":"application/x-www-form-urlencoded"}],"body":{"mode":"urlencoded","urlencoded":[{"key":"p_block","type":"text","value":"{{p_block}}"},{"key":"p_custom_select","type":"text","value":"{{p_custom_select}}"},{"key":"p_base64","value":"{{p_base64}}","type":"text"}]},"url":{"raw":"{{base_servlet_url}}/block","host":["{{base_servlet_url}}"],"path":["block"]}},"response":[],"uid":"5845306-002821ce-c9af-4c71-8864-9e0ae4bb2f83"},{"name":"StateSteps","event":[{"listen":"prerequest","script":{"id":"4fbf6c8f-ea48-43fd-8fd2-c392483b00a6","exec":["if(data.p_sql !== \"\"){\r","    console.log(\"p_block==\" + data.p_block);\r","    if(pm.variables.get(\"p_base64\")==\"Y\")\r","        pm.variables.set(\"p_block\",btoa(data.p_block));\r","    else\r","        pm.variables.set(\"p_block\", data.p_block);\r","}"],"type":"text/javascript"}},{"listen":"test","script":{"id":"2768688c-40ee-480e-ab3e-dcdbe1ebee4f","exec":["","tests[\"Status code is 200\"] = responseCode.code === 200;","if(data.error_code !== \"\" && pm.variables.get(\"LimitedSql\")==\"Y\"){","    //console.log(pm.response.text());","    console.log(data.error_code);","    pm.test(data.Description, function () {","        pm.expect(pm.response.text()).to.include(\"<ERROR_MESSAGE>\");","        pm.expect(pm.response.text()).to.include(\"SECURITY VIOLATION: \" + data.error_code);","    });","} else {","        pm.test(\"Should not return security violation error\", function(){","        pm.expect(pm.response.text()).to.not.include(\"<SECURITY VIOLATION\");","    });","}","","//clear variables","pm.variables.set(\"p_block\",\"\");","","// Exit run","postman.setNextRequest(null);"],"type":"text/javascript"}}],"id":"a67deb0b-7ff8-4e21-9a3e-5b4413d075e4","protocolProfileBehavior":{"disableBodyPruning":true},"request":{"method":"POST","header":[{"key":"Content-Type","name":"Content-Type","value":"application/x-www-form-urlencoded","type":"text"}],"body":{"mode":"urlencoded","urlencoded":[{"key":"p_session","value":"{{block_session_id}}","type":"text"},{"key":"p_block","value":"{{p_block}}","type":"text"},{"key":"p_base64","value":"{{p_base64}}","type":"text"}]},"url":{"raw":"{{base_servlet_url}}/statestep","host":["{{base_servlet_url}}"],"path":["statestep"]}},"response":[],"uid":"5845306-a67deb0b-7ff8-4e21-9a3e-5b4413d075e4"},{"name":"ExecuteState","event":[{"listen":"test","script":{"id":"a3acb0e7-edaa-41e1-9acf-0046feb177aa","exec":["\r","tests[\"Status code is 200\"] = responseCode.code === 200;\r","if(data.error_code !== \"\" && pm.variables.get(\"LimitedSql\")==\"Y\"){\r","    //console.log(pm.response.text());\r","    console.log(data.error_code);\r","    pm.test(data.Description, function () {\r","        pm.expect(pm.response.text()).to.include(\"<ERROR_MESSAGE>\");\r","        pm.expect(pm.response.text()).to.include(\"SECURITY VIOLATION: \" + data.error_code);\r","    });\r","} else {\r","        pm.test(\"Should not return security violation error\", function(){\r","        pm.expect(pm.response.text()).to.not.include(\"<SECURITY VIOLATION\");\r","    });\r","}\r","\r","//clear variables\r","pm.variables.set(\"p_custom_select\",\"\");\r","\r","// Exit run\r","postman.setNextRequest(null);"],"type":"text/javascript"}},{"listen":"prerequest","script":{"id":"e64a7e77-187a-4cbe-99c8-cdce77ecba42","exec":["if(!data.p_custom_select !== \"\"){\r","     console.log(\"p_custom_select==\" + data.p_custom_select);\r","    if(pm.variables.get(\"p_base64\")==\"Y\")\r","        pm.variables.set(\"p_custom_select\",btoa(data.p_custom_select));\r","    else\r","        pm.variables.set(\"p_custom_select\", data.p_custom_select);\r","}"],"type":"text/javascript"}}],"id":"cd65b218-d3aa-4a1e-8153-afe14e167238","protocolProfileBehavior":{"disableBodyPruning":true},"request":{"method":"POST","header":[{"key":"Content-Type","name":"Content-Type","value":"application/x-www-form-urlencoded","type":"text"}],"body":{"mode":"urlencoded","urlencoded":[{"key":"p_session","value":"9999999","type":"text"},{"key":"p_custom_select","value":"{{p_custom_select}}","type":"text"}]},"url":{"raw":"{{base_servlet_url}}/executeState","host":["{{base_servlet_url}}"],"path":["executeState"]}},"response":[],"uid":"5845306-cd65b218-d3aa-4a1e-8153-afe14e167238"}]}}